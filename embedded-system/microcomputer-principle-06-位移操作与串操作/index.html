<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="keywords" content="Hexo Theme Keep"><meta name="description" content="Hexo Theme Keep"><meta name="author" content="Carpe Tu"><title>microcomputer_principle_06_位移操作与串操作 | Carpe&#39;s Blog</title><link rel="stylesheet" href="/css/style.css"><link rel="shortcut icon" href="https://pic.imgdb.cn/item/622b2b2e5baa1a80abf6fcff.png"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/font/css/fontawesome.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/font/css/regular.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/font/css/solid.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/font/css/brands.min.css"><script id="hexo-configurations">let KEEP=window.KEEP||{};KEEP.hexo_config={hostname:"overduse.github.io",root:"/",language:"en",path:"search.json"},KEEP.theme_config={toc:{enable:!0,number:!0,expand_all:!0,init_open:!0},style:{primary_color:"#0066cc",logo:"https://pic.imgdb.cn/item/622b2b2e5baa1a80abf6fcff.png",favicon:"https://pic.imgdb.cn/item/622b2b2e5baa1a80abf6fcff.png",avatar:"https://pic.imgdb.cn/item/639ece3eb1fccdcd365542dd.jpg",font_size:"15.6px",font_family:null,hover:{shadow:!0,scale:!0},first_screen:{enable:!0,header_transparent:!0,background_img:"/images/bg.svg",description:"Keep writing and Keep loving.",font_color:null,hitokoto:!0},scroll:{progress_bar:!0,percent:!0}},local_search:{enable:!0,preload:!0},code_copy:{},code_block:{tools:{enable:!0,style:"mac"},highlight_theme:"default"},side_tools:{},pjax:{enable:!0},lazyload:{enable:!0},comment:{enable:!1,use:"valine",valine:{appid:null,appkey:null,placeholder:null},gitalk:{github_id:null,github_admins:null,repository:null,client_id:null,client_secret:null},twikoo:{env_id:null,region:null,version:"1.6.7"},waline:{server_url:null,reaction:!1,version:2}},post:{author_label:{enable:!0,auto:!1,custom_label_list:["Bell","Red Whistle","Blue Whistle","Moon Whistle","Black Whistle","YouWorth"]},word_count:{enable:!0,wordcount:!0,min2read:!0},img_align:"center",copyright_info:!0},version:"3.6.1"},KEEP.language_ago={second:"%s seconds ago",minute:"%s minutes ago",hour:"%s hours ago",day:"%s days ago",week:"%s weeks ago",month:"%s months ago",year:"%s years ago"},KEEP.language_code_block={copy:"Copy code",copied:"Copied",fold:"Fold code block",folded:"Folded"},KEEP.language_copy_copyright={copy:"Copy copyright info",copied:"Copied",title:"Original article title",author:"Original article author",link:"Original article link"}</script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Keep Theme" type="application/atom+xml">
<style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head><body><div class="progress-bar-container"><span class="scroll-progress-bar"></span> <span class="pjax-progress-bar"></span> <i class="pjax-progress-icon fas fa-circle-notch fa-spin"></i></div><main class="page-container"><div class="page-main-content"><div class="page-main-content-top"><header class="header-wrapper"><div class="header-content"><div class="left"><a class="logo-image" href="/"><img src="https://pic.imgdb.cn/item/622b2b2e5baa1a80abf6fcff.png"> </a><a class="logo-title" href="/">Carpe&#39;s Blog</a></div><div class="right"><div class="pc"><ul class="menu-list"><li class="menu-item"><a href="/">HOME</a></li><li class="menu-item"><a href="/archives">ARCHIVES</a></li><li class="menu-item"><a href="/categories">CATEGORIES</a></li><li class="menu-item"><a href="/tags">TAGS</a></li><li class="menu-item"><a href="/links">LINKS</a></li><li class="menu-item"><a href="/about">ABOUT</a></li><li class="menu-item"><a href="/changelog">CHANGELOG</a></li><li class="menu-item search search-popup-trigger"><i class="fas fa-search"></i></li></ul></div><div class="mobile"><div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div><div class="icon-item menu-bar"><div class="menu-bar-middle"></div></div></div></div></div><div class="header-drawer"><ul class="drawer-menu-list"><li class="drawer-menu-item flex-center"><a href="/">HOME</a></li><li class="drawer-menu-item flex-center"><a href="/archives">ARCHIVES</a></li><li class="drawer-menu-item flex-center"><a href="/categories">CATEGORIES</a></li><li class="drawer-menu-item flex-center"><a href="/tags">TAGS</a></li><li class="drawer-menu-item flex-center"><a href="/links">LINKS</a></li><li class="drawer-menu-item flex-center"><a href="/about">ABOUT</a></li><li class="drawer-menu-item flex-center"><a href="/changelog">CHANGELOG</a></li></ul></div><div class="window-mask"></div></header></div><div class="page-main-content-middle"><div class="main-content"><div class="fade-in-down-animation"><div class="post-page-container"><div class="article-content-container"><div class="article-title"><span class="title-hover-animation">microcomputer_principle_06_位移操作与串操作</span></div><div class="article-header"><div class="avatar"><img src="https://pic.imgdb.cn/item/639ece3eb1fccdcd365542dd.jpg"></div><div class="info"><div class="author"><span class="name">Carpe Tu</span> <span class="author-label">Black Whistle</span></div><div class="meta-info"><div class="article-meta-info"><span class="article-date article-meta-item"><i class="fa-regular fa-calendar-plus"></i>&nbsp; <span class="pc">2023-02-19 19:11:25</span> <span class="mobile">2023-02-19 19:11</span> </span><span class="article-update-date article-meta-item"><i class="fas fa-file-pen"></i>&nbsp; <span class="pc">2023-02-24 18:43:32</span> </span><span class="article-categories article-meta-item"><i class="fas fa-folder"></i>&nbsp;<ul><li><a href="/categories/embedded-system/">embedded system</a>&nbsp;</li></ul></span><span class="article-tags article-meta-item"><i class="fas fa-tags"></i>&nbsp;<ul><li><a href="/tags/Courses-Notes/">Courses Notes</a>&nbsp;</li><li>| <a href="/tags/xjtu/">xjtu</a>&nbsp;</li></ul></span><span class="article-wordcount article-meta-item"><i class="fas fa-file-word"></i>&nbsp;<span>2.3k Words</span> </span><span class="article-min2read article-meta-item"><i class="fas fa-clock"></i>&nbsp;<span>8 Mins</span> </span><span class="article-pv article-meta-item"><i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span></span></div></div></div></div><div class="article-content keep-markdown-body"><h1 id="移位操作指令"><a href="#移位操作指令" class="headerlink" title="移位操作指令"></a>移位操作指令</h1><ul><li>控制二进制位向左或向右移动的指令<ul><li>非循环移位指令(线性)</li><li>循环移位指令</li></ul></li></ul><blockquote><ul><li>指令格式在形式上为双操作数，本质上为 <u>单操作数</u>；</li><li>指令的目的操作数为被动移动对象，源操作数为移动次数<ul><li>当目标为存储器操作数时，需要说明其字长</li></ul></li><li>移动1位时由指令直接给出；移动两位以及以上时，移位次数必须由CL指定。<br>指令源操作数只能是1或CL</li></ul></blockquote><h2 id="非循环移位指令"><a href="#非循环移位指令" class="headerlink" title="非循环移位指令"></a>非循环移位指令</h2><ul><li>逻辑左移</li><li>算术左移</li><li>逻辑右移</li><li>算术右移</li></ul><blockquote><p>非循环移位指令是一种破坏性的移位，发生操作后，就不再可以还原了。</p></blockquote><h3 id="算术左移和逻辑左移"><a href="#算术左移和逻辑左移" class="headerlink" title="算术左移和逻辑左移"></a>算术左移和逻辑左移</h3><p>算术左移指令：(针对有符号数)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SAL OPRD, 1</span><br><span class="line">SAL OPRD, CL</span><br></pre></td></tr></table></figure><p>逻辑左移指令：(针对无符号数)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SHL OPRD, 1</span><br><span class="line">SHL OPRD, CL</span><br></pre></td></tr></table></figure><blockquote><p>对于左移来讲，无论是算术还是逻辑层面操作都是一样的<br><strong>将最高位移动到CF，最低位补零</strong></p></blockquote><h3 id="逻辑右移"><a href="#逻辑右移" class="headerlink" title="逻辑右移"></a>逻辑右移</h3><p>无符号数右移操作</p><ul><li>format:<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SHR OPRD, 1</span><br><span class="line">SHR OPRD, CL </span><br></pre></td></tr></table></figure></li></ul><p>原理： 最低位–&gt; CF, 最高位补0，其余右移。</p><h3 id="算术右移"><a href="#算术右移" class="headerlink" title="算术右移"></a>算术右移</h3><p>针对有符号数右移操作</p><ul><li>format:<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SAR OPRD, 1</span><br><span class="line">SAR OPRD, CL</span><br></pre></td></tr></table></figure></li></ul><p><img lazyload="" alt="SAR" data-src="https://pic.imgdb.cn/item/63f23c36f144a0100750d411.jpg"></p><blockquote><p>算术右移的高位会用最高位的数值补全</p></blockquote><h3 id="非循环移位指令应用"><a href="#非循环移位指令应用" class="headerlink" title="非循环移位指令应用"></a>非循环移位指令应用</h3><ul><li>左移可以实现乘法运算</li><li>右移可以实现除法运算</li></ul><h2 id="循环移位指令"><a href="#循环移位指令" class="headerlink" title="循环移位指令"></a>循环移位指令</h2><ul><li>不带进位位的循环移位<ul><li>左移 ROL</li><li>右移 ROR</li></ul></li></ul><p><img lazyload="" alt="cycle" data-src="https://pic.imgdb.cn/item/63f23eb1f144a01007548c0f.jpg"></p><ul><li>带进位位的循环移位<ul><li>左移 RCL</li><li>右移 RCR</li></ul></li></ul><p><img lazyload="" alt="image" data-src="https://pic.imgdb.cn/item/63f23ef1f144a0100754d94f.jpg"></p><p><strong>指令格式、对操作数的要求与非循环移位指令相同</strong></p><h3 id="循环移位应用"><a href="#循环移位应用" class="headerlink" title="循环移位应用"></a>循环移位应用</h3><ul><li>用于对某些位状态的测试；</li><li>高位部分和低位部分的交换；</li><li>与非循环移位指令一起组成32bit或更长字长数的移位</li></ul><p><img lazyload="" alt="image" data-src="https://pic.imgdb.cn/item/63f23fa5f144a0100755c52e.jpg"></p><ul><li>题目分析：<ul><li>压缩BCD码是用4位二进制码表示1位十进制数—-&gt;1字节表示2位压缩BCD</li><li>转换ASCII码时需要分别转换高4位（十位数）和低4位（个位数）</li><li>0～9的ASCII码的高4位均为0011(03H)</li><li>转换低4位时应先使高4位清零，转换高四位时须先将高4位移动到低4位的位置</li></ul></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">      LEA SI, M1</span><br><span class="line">      LEA DI, M2</span><br><span class="line">      MOV CH, 4     ; CL用于移位，CH用于存储循环数</span><br><span class="line">NEXT: MOV AL, [SI]</span><br><span class="line">      MOV BL, AL    ; BL备份原数据, AL的操作会破坏源数据</span><br><span class="line">      AND AL, 0FH   ; 高位清零</span><br><span class="line">      OR AL, 30H    ; 高位设为3, X对应3XH</span><br><span class="line">      MOV [DI], AL</span><br><span class="line">      INC DI</span><br><span class="line">      MOV AL, BL</span><br><span class="line">      MOV CL, 4</span><br><span class="line">      SHR AL, CL</span><br><span class="line">      OR AL, 30H</span><br><span class="line">      MOV [DI], AL</span><br><span class="line">      INC DI</span><br><span class="line">      INC SI</span><br><span class="line">      DEC CH</span><br><span class="line">      JNZ NEXT</span><br><span class="line">      HLT</span><br></pre></td></tr></table></figure><h1 id="串操作"><a href="#串操作" class="headerlink" title="串操作"></a>串操作</h1><ul><li>针对数据块或字符串的操作</li><li>可实现存储器到存储器的数据传送；(双操作数指令，有时候，必须要求，两个操作数都是存储器操作)</li><li>待操作的数据串称为源串，目标地址称为目标串。</li></ul><h2 id="串操作指令说明"><a href="#串操作指令说明" class="headerlink" title="串操作指令说明"></a>串操作指令说明</h2><ul><li>串操作指令的操作对象是多个字节数（一串字符或数据），因此，指令的执行需要确定：<ul><li>串所在区域</li><li>串首地址（原串、目标串起始地址）</li><li>串长度（大小）</li><li>串的操作方向</li></ul></li></ul><h2 id="串操作指令的要求"><a href="#串操作指令的要求" class="headerlink" title="串操作指令的要求"></a>串操作指令的要求</h2><ul><li>串所在区域及首地址：<ul><li>源串<strong>一般</strong>存放在数据段，偏移地址由SI指定。允许段重设。</li><li>目标串<strong>必须</strong>在附加段，偏移地址由DI指定。</li></ul></li><li>串长度：<ul><li><em>串长度值由CX指定</em></li></ul></li><li>串的操作方向：<ul><li>由DF标志位决定。指令根据DF状态自动修改地址指针<ul><li>DF=0 –&gt; 增地址方向</li><li>DF=1 –&gt; 减地址方向</li></ul></li></ul></li></ul><blockquote><p>会有专门的指令设置DF值<br>通过增加<strong>重复前缀</strong>，可以实现对CX值对自动修改</p></blockquote><h3 id="重复前缀"><a href="#重复前缀" class="headerlink" title="重复前缀"></a>重复前缀</h3><ul><li>无条件重复<ul><li>REP(repeat)<ul><li><u>当CX<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.486ex" xmlns="http://www.w3.org/2000/svg" width="1.76ex" height="2.106ex" role="img" focusable="false" viewBox="0 -716 778 931"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2260" d="M166 -215T159 -215T147 -212T141 -204T139 -197Q139 -190 144 -183L306 133H70Q56 140 56 153Q56 168 72 173H327L406 327H72Q56 332 56 347Q56 360 70 367H426Q597 702 602 707Q605 716 618 716Q625 716 630 712T636 703T638 696Q638 692 471 367H707Q722 359 722 347Q722 336 708 328L451 327L371 173H708Q722 163 722 153Q722 140 707 133H351Q175 -210 170 -212Q166 -215 159 -215Z"></path></g></g></g></svg></mjx-container>0时，REP后的指令将继续重复执行</u></li><li>常用于传送类指令前 -&gt; 未传完则继续传送</li></ul></li></ul></li><li>条件重复<ul><li>相等（为零）重复：REPE（REPZ）<ul><li>CX<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.486ex" xmlns="http://www.w3.org/2000/svg" width="1.76ex" height="2.106ex" role="img" focusable="false" viewBox="0 -716 778 931"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2260" d="M166 -215T159 -215T147 -212T141 -204T139 -197Q139 -190 144 -183L306 133H70Q56 140 56 153Q56 168 72 173H327L406 327H72Q56 332 56 347Q56 360 70 367H426Q597 702 602 707Q605 716 618 716Q625 716 630 712T636 703T638 696Q638 692 471 367H707Q722 359 722 347Q722 336 708 328L451 327L371 173H708Q722 163 722 153Q722 140 707 133H351Q175 -210 170 -212Q166 -215 159 -215Z"></path></g></g></g></svg></mjx-container>0<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.05ex" xmlns="http://www.w3.org/2000/svg" width="1.509ex" height="1.403ex" role="img" focusable="false" viewBox="0 -598 667 620"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2229" d="M88 -21T75 -21T55 -7V200Q55 231 55 280Q56 414 60 428Q61 430 61 431Q77 500 152 549T332 598Q443 598 522 544T610 405Q611 399 611 194V-7Q604 -22 591 -22Q582 -22 572 -9L570 405Q563 433 556 449T529 485Q498 519 445 538T334 558Q251 558 179 518T96 401Q95 396 95 193V-7Q88 -21 75 -21Z"></path></g></g></g></svg></mjx-container>ZF=1, 则前缀后的指令将继续重复执行</li></ul></li><li>不相等（不为零）重复：REPNE（REPNZ）<ul><li>CX<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.486ex" xmlns="http://www.w3.org/2000/svg" width="1.76ex" height="2.106ex" role="img" focusable="false" viewBox="0 -716 778 931"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2260" d="M166 -215T159 -215T147 -212T141 -204T139 -197Q139 -190 144 -183L306 133H70Q56 140 56 153Q56 168 72 173H327L406 327H72Q56 332 56 347Q56 360 70 367H426Q597 702 602 707Q605 716 618 716Q625 716 630 712T636 703T638 696Q638 692 471 367H707Q722 359 722 347Q722 336 708 328L451 327L371 173H708Q722 163 722 153Q722 140 707 133H351Q175 -210 170 -212Q166 -215 159 -215Z"></path></g></g></g></svg></mjx-container>0<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.05ex" xmlns="http://www.w3.org/2000/svg" width="1.509ex" height="1.403ex" role="img" focusable="false" viewBox="0 -598 667 620"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2229" d="M88 -21T75 -21T55 -7V200Q55 231 55 280Q56 414 60 428Q61 430 61 431Q77 500 152 549T332 598Q443 598 522 544T610 405Q611 399 611 194V-7Q604 -22 591 -22Q582 -22 572 -9L570 405Q563 433 556 449T529 485Q498 519 445 538T334 558Q251 558 179 518T96 401Q95 396 95 193V-7Q88 -21 75 -21Z"></path></g></g></g></svg></mjx-container>ZF=0, 则前缀后的指令将继续重复执行</li></ul></li></ul></li></ul><blockquote><p>条件前缀常用于运算累指令前，当:</p><ol><li>操作未结束 AND 结果=0 or</li><li>操作未结束 AND 结果<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.486ex" xmlns="http://www.w3.org/2000/svg" width="1.76ex" height="2.106ex" role="img" focusable="false" viewBox="0 -716 778 931"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2260" d="M166 -215T159 -215T147 -212T141 -204T139 -197Q139 -190 144 -183L306 133H70Q56 140 56 153Q56 168 72 173H327L406 327H72Q56 332 56 347Q56 360 70 367H426Q597 702 602 707Q605 716 618 716Q625 716 630 712T636 703T638 696Q638 692 471 367H707Q722 359 722 347Q722 336 708 328L451 327L371 173H708Q722 163 722 153Q722 140 707 133H351Q175 -210 170 -212Q166 -215 159 -215Z"></path></g></g></g></svg></mjx-container>0<br>使其后的指令继续重复执行。</li></ol></blockquote><h2 id="串操作指令"><a href="#串操作指令" class="headerlink" title="串操作指令"></a>串操作指令</h2><ul><li>串传送MOVS</li><li>串比较CMPS</li><li>串扫描SCAS</li><li>串装入LODS</li><li>串送存STOS</li></ul><p><strong>串操作指令流程</strong><br><img lazyload="" alt="串操作指令流程" data-src="https://pic.imgdb.cn/item/63f2da6af144a01007fc1393.jpg"></p><blockquote><p>在串操作中，右部4个模块，用（一条指令+重复前缀）来完成<br>完成一个字节（字）操作+修改地址指针，由串操作指令实现<br>重复前缀，实现了循环结构</p></blockquote><p><img lazyload="" alt="string" data-src="https://pic.imgdb.cn/item/63f2dba3f144a01007fe5620.jpg"></p><ul><li><p>若按增地址方向操作，串操作结束时：</p><ul><li>串传送指令： 指针将指向串尾+1</li><li>串比较类指令：指针将指向结束位+1</li></ul></li><li><p>若按减地址方向操作，串操作结束时：</p><ul><li>串传送指令： 指针将指向串尾-1</li><li>串比较累指令： 指针将指向结束位-1</li></ul></li></ul><h3 id="串传送MOVS"><a href="#串传送MOVS" class="headerlink" title="串传送MOVS"></a>串传送MOVS</h3><ul><li>func:<ul><li>将源数据串传送到目标地址</li></ul></li><li>format:<ol><li>MOVS OPRD1, OPRD2(仅用于对源串<strong>段重设</strong>)</li><li>MOVSB(按字节传送)</li><li>MOVSW(按字传送)</li></ol></li><li><strong>串传送指令通常与无条件重复前缀连用</strong></li></ul><p>应用例子：</p><p>分别用MOV指令和MOVS指令编写将200字节数数据从内存数据段MEM1为首地址的区域送到同一逻辑段MEM2为首地址的区域中的程序。</p><p>MOV指令实现算法：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">      LEA SI, MEM1</span><br><span class="line">      LEA DI, MEM2</span><br><span class="line">      MOV CX, 200</span><br><span class="line">NEXT: MOV AL, [SI]</span><br><span class="line">      MOV [DI], AL</span><br><span class="line">      INC SI</span><br><span class="line">      INC DI</span><br><span class="line">      DEC CX</span><br><span class="line">      JNZ NEXT</span><br><span class="line">      HLT</span><br></pre></td></tr></table></figure><p>MOVS指令实现算法：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">LEA SI, MEM1</span><br><span class="line">LEA DI, MEM2</span><br><span class="line">MOV CX, 200</span><br><span class="line">CLD           ;Clear DF</span><br><span class="line">REP MOVSB     ;按字节传送，并且修改字节指针</span><br><span class="line">HLT</span><br></pre></td></tr></table></figure><h3 id="串比较CMPS"><a href="#串比较CMPS" class="headerlink" title="串比较CMPS"></a>串比较CMPS</h3><p>在上一节的例子中，完成操作后，检验代码是否正确运行————可以利用<em>串比较指令进行检验</em></p><ul><li>func:<ul><li>用于实现两个数据串的比较</li></ul></li><li>manipulation:<ul><li>目标串-源串，结果不写回目标地址</li><li>常与条件重复前缀连用</li></ul></li><li>format:<ol><li>CMPS OPRD1 OPRD2 (仅段重设采用)</li><li>CMPSB</li><li>CMPSW</li></ol></li></ul><blockquote><p><strong>前缀的操作对标志位不影响</strong>(虽然会进行CX-1操作)<br>串比较指令会影响全部6个标志位</p></blockquote><ul><li>测试上例中200Bytes数据传送是否正确。</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">      LEA SI, MEM1</span><br><span class="line">      LEA DI, MEM2</span><br><span class="line">      MOV CX, 200</span><br><span class="line">      CLD</span><br><span class="line">      REPE CMPSB    ; CX=0 or ZF=0 pause</span><br><span class="line">      JZ STOP       ; 条件转移-&gt; ZF=1 数据串完全相同,转移到STOP</span><br><span class="line">      DEC SI        ; 指向不匹配的内存单元</span><br><span class="line">      MOV AL, [SI]  ; 这三句用于取出，地址+元素</span><br><span class="line">      MOV BX, SI</span><br><span class="line">STOP: HLT</span><br></pre></td></tr></table></figure><h3 id="串扫描SCAS-scan-string"><a href="#串扫描SCAS-scan-string" class="headerlink" title="串扫描SCAS(scan string)"></a>串扫描SCAS(scan string)</h3><p>常用于在指定存储区域中寻找某个关键字</p><ul><li>format:<ul><li>SCAS OPRD &lt;– 目标操作数(被查找的长串)<br>(目标操作数，一般在附加段ES，指针为DI)</li><li>SCASB</li><li>SCASW</li></ul></li><li>执行与CMPS指令相似的操作，区别是：<ul><li>这里的源操作数是AX或AL(需要查找的pattern)<br>(按字节扫描AL，按字扫描AX)</li></ul></li></ul><p><strong>串扫描指令应用例：</strong></p><ul><li>在ES段中从2000H单元开始存放了10个字符，寻找其中有无字符“A”。若有则记下搜索次数，将搜索次数写入到DATA1单元，并将存放“A”的地址写入DATA2单元。</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">      MOV DI, 2000H</span><br><span class="line">      MOV BX, DI</span><br><span class="line">      MOV CX, 0AH</span><br><span class="line">      MOV AL, 'A'</span><br><span class="line">      CLD</span><br><span class="line">      REPNZ SCASB</span><br><span class="line">      JZ FOUND</span><br><span class="line">      MOV DI, 0</span><br><span class="line">      JMP DONE</span><br><span class="line"></span><br><span class="line">FOUND:DEC DI        ; 减1指向匹配字节地址</span><br><span class="line">      MOV DATA2, DI</span><br><span class="line">      INC DI        ; 回到原地址</span><br><span class="line">      SUB DI, BX    ; 进行多少次增位，就有几次搜索</span><br><span class="line"></span><br><span class="line">DONE: MOV DATA1, DI</span><br><span class="line">      HLT</span><br></pre></td></tr></table></figure><h3 id="串装入LODS"><a href="#串装入LODS" class="headerlink" title="串装入LODS"></a>串装入LODS</h3><ul><li><p>format:</p><ul><li>LODS OPRD –&gt; 源操作数，指针<strong>必须使用SI</strong>寄存器</li><li>LODSB</li><li>LODSW</li></ul></li><li><p>manipulation:</p><ul><li>对字节: AL &lt;– [DS:SI]</li><li>对字 : AX &lt;– [DS:SI]</li></ul></li><li><p>用于将内存某个区域的数据串一次装入累加器，以便显示或输出到接口。</p></li><li><p>LODS指令一般不加重复前缀。</p></li></ul><blockquote><p>与MOV指令无异</p></blockquote><h3 id="串存储STOS-store-string"><a href="#串存储STOS-store-string" class="headerlink" title="串存储STOS(store string)"></a>串存储STOS(store string)</h3><ul><li>format：<ul><li>STOS OPRD –&gt; 目标操作数</li><li>STOSB</li><li>STOSW</li></ul></li><li>manipulation:<ul><li>对字节: AL –&gt; [ES:DI]</li><li>对字: AX –&gt; [ES:DI]</li></ul></li></ul><hr><ul><li>常用于将内存某个区域置同样的值</li><li>此时：<ul><li>将待送存的数据放入AL（字节数）或AX（字数据）；</li><li>确定操作方向（增/减地址）和区域大小（串长度值）</li><li>使用串存储指令+无条件重复前缀，实现数据传送</li></ul></li></ul><h2 id="串操作Notes"><a href="#串操作Notes" class="headerlink" title="串操作Notes"></a>串操作Notes</h2><ul><li>需要定义附加段（ES<ul><li>目标操作数必须在附加段</li><li>(第四章会学习如何定义附加段)</li></ul></li><li>需要设置数据的操作方向<ul><li>确定DF的状态</li></ul></li><li>源串和目标串指针分别为SI和DI</li><li>串长度值必须由CX给出</li><li>注意<strong>重复前缀</strong>的使用方法<ul><li>传送类指令前加无条件重复前缀</li><li>串比较类指令前加条件重复前缀，但前缀不影响ZF状态</li></ul></li></ul><blockquote><p>无论是串传送还是串比较完成，无论是否满足，都是先<strong>修改指针</strong>+<strong>修改长度值</strong>，再判断是否满足条件。<br>哪怕串比较不相等，不再继续，但是<strong>指针已经在跳出位置下一内存单元</strong>了</p></blockquote></div><div class="post-copyright-info"><div class="article-copyright-info-container"><ul class="copyright-info-content"><li class="post-title"><span class="type">Post title</span>: <span class="content">microcomputer_principle_06_位移操作与串操作</span></li><li class="post-author"><span class="type">Post author</span>: <span class="content">Carpe Tu</span></li><li class="post-time"><span class="type">Create time</span>: <span class="content">2023-02-19 19:11:25</span></li><li class="post-link"><span class="type">Post link</span>: <span class="content">embedded-system/microcomputer-principle-06-位移操作与串操作/</span></li><li class="post-license"><span class="type">Copyright notice</span>: <span class="content">All articles in this blog are licensed under <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">BY-NC-SA</a> unless stating additionally.</span></li></ul><div class="copy-copyright-info flex-center tooltip" data-content="Copy copyright info" data-offset-y="-2px"><i class="fa-solid fa-copy"></i></div></div></div><ul class="post-tags-box"><li class="tag-item"><a href="/tags/Courses-Notes/">#Courses Notes</a>&nbsp;</li><li class="tag-item"><a href="/tags/xjtu/">#xjtu</a>&nbsp;</li></ul><div class="article-nav"><div class="article-prev"><a class="prev" rel="prev" href="/embedded-system/microcomputer-principle-07-%E7%A8%8B%E5%BA%8F%E6%8E%A7%E5%88%B6%E6%8C%87%E4%BB%A4/"><span class="left arrow-icon flex-center"><i class="fas fa-chevron-left"></i> </span><span class="title flex-center"><span class="post-nav-title-item">microcomputer_principle_07_程序控制指令</span> <span class="post-nav-item">Prev posts</span></span></a></div><div class="article-next"><a class="next" rel="next" href="/embedded-system/microcomputer-principle-05-%E7%AE%97%E6%9C%AF%E8%BF%90%E7%AE%97%E5%92%8C%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97/"><span class="title flex-center"><span class="post-nav-title-item">microcomputer_principle_05_算术运算和逻辑运算</span> <span class="post-nav-item">Next posts</span> </span><span class="right arrow-icon flex-center"><i class="fas fa-chevron-right"></i></span></a></div></div></div><div class="toc-content-container"><div class="post-toc-wrap"><div class="post-toc"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%A7%BB%E4%BD%8D%E6%93%8D%E4%BD%9C%E6%8C%87%E4%BB%A4"><span class="nav-number">1.</span> <span class="nav-text">移位操作指令</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%9D%9E%E5%BE%AA%E7%8E%AF%E7%A7%BB%E4%BD%8D%E6%8C%87%E4%BB%A4"><span class="nav-number">1.1.</span> <span class="nav-text">非循环移位指令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AE%97%E6%9C%AF%E5%B7%A6%E7%A7%BB%E5%92%8C%E9%80%BB%E8%BE%91%E5%B7%A6%E7%A7%BB"><span class="nav-number">1.1.1.</span> <span class="nav-text">算术左移和逻辑左移</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%BB%E8%BE%91%E5%8F%B3%E7%A7%BB"><span class="nav-number">1.1.2.</span> <span class="nav-text">逻辑右移</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AE%97%E6%9C%AF%E5%8F%B3%E7%A7%BB"><span class="nav-number">1.1.3.</span> <span class="nav-text">算术右移</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%9E%E5%BE%AA%E7%8E%AF%E7%A7%BB%E4%BD%8D%E6%8C%87%E4%BB%A4%E5%BA%94%E7%94%A8"><span class="nav-number">1.1.4.</span> <span class="nav-text">非循环移位指令应用</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BE%AA%E7%8E%AF%E7%A7%BB%E4%BD%8D%E6%8C%87%E4%BB%A4"><span class="nav-number">1.2.</span> <span class="nav-text">循环移位指令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BE%AA%E7%8E%AF%E7%A7%BB%E4%BD%8D%E5%BA%94%E7%94%A8"><span class="nav-number">1.2.1.</span> <span class="nav-text">循环移位应用</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%B2%E6%93%8D%E4%BD%9C"><span class="nav-number">2.</span> <span class="nav-text">串操作</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%B2%E6%93%8D%E4%BD%9C%E6%8C%87%E4%BB%A4%E8%AF%B4%E6%98%8E"><span class="nav-number">2.1.</span> <span class="nav-text">串操作指令说明</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%B2%E6%93%8D%E4%BD%9C%E6%8C%87%E4%BB%A4%E7%9A%84%E8%A6%81%E6%B1%82"><span class="nav-number">2.2.</span> <span class="nav-text">串操作指令的要求</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%87%8D%E5%A4%8D%E5%89%8D%E7%BC%80"><span class="nav-number">2.2.1.</span> <span class="nav-text">重复前缀</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%B2%E6%93%8D%E4%BD%9C%E6%8C%87%E4%BB%A4"><span class="nav-number">2.3.</span> <span class="nav-text">串操作指令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%B2%E4%BC%A0%E9%80%81MOVS"><span class="nav-number">2.3.1.</span> <span class="nav-text">串传送MOVS</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%B2%E6%AF%94%E8%BE%83CMPS"><span class="nav-number">2.3.2.</span> <span class="nav-text">串比较CMPS</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%B2%E6%89%AB%E6%8F%8FSCAS-scan-string"><span class="nav-number">2.3.3.</span> <span class="nav-text">串扫描SCAS(scan string)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%B2%E8%A3%85%E5%85%A5LODS"><span class="nav-number">2.3.4.</span> <span class="nav-text">串装入LODS</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%B2%E5%AD%98%E5%82%A8STOS-store-string"><span class="nav-number">2.3.5.</span> <span class="nav-text">串存储STOS(store string)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%B2%E6%93%8D%E4%BD%9CNotes"><span class="nav-number">2.4.</span> <span class="nav-text">串操作Notes</span></a></li></ol></li></ol></div></div></div></div></div></div></div><div class="page-main-content-bottom"><footer class="footer"><div class="info-container"><div class="copyright-info info-item">&copy; <span>2021</span> - 2023 &nbsp;<i class="fas fa-heart icon-animate"></i> &nbsp;<a href="/">Carpe Tu</a></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="website-count info-item">Visitor Count&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp; Totalview&nbsp;<span id="busuanzi_value_site_pv"></span></div><div class="theme-info info-item">Powered by <a target="_blank" href="https://hexo.io">Hexo</a>&nbsp;|&nbsp;Theme&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.6.1</a></div></div></footer></div></div><div class="post-tools"><div class="post-tools-container"><ul class="tools-list"><li class="tools-item flex-center toggle-show-toc"><i class="fas fa-list"></i></li></ul></div></div><div class="right-bottom-side-tools"><div class="side-tools-container"><ul class="side-tools-list"><li class="tools-item tool-font-adjust-plus flex-center"><i class="fas fa-search-plus"></i></li><li class="tools-item tool-font-adjust-minus flex-center"><i class="fas fa-search-minus"></i></li><li class="tools-item tool-dark-light-toggle flex-center"><i class="fas fa-moon"></i></li><li class="tools-item rss flex-center"><a class="flex-center" href="/atom.xml" target="_blank"><i class="fas fa-rss"></i></a></li><li class="tools-item tool-scroll-to-bottom flex-center"><i class="fas fa-arrow-down"></i></li></ul><ul class="exposed-tools-list"><li class="tools-item tool-toggle-show flex-center"><i class="fas fa-cog fa-spin"></i></li><li class="tools-item tool-scroll-to-top flex-center"><i class="arrow-up fas fa-arrow-up"></i> <span class="percent"></span></li></ul></div></div><div class="zoom-in-image-mask"><img class="zoom-in-image"></div><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-input-field-pre"><i class="fas fa-keyboard"></i></span><div class="search-input-container"><input autocomplete="off" autocorrect="off" autocapitalize="off" placeholder="Search..." spellcheck="false" type="search" class="search-input"></div><span class="close-popup-btn"><i class="fas fa-times"></i></span></div><div id="search-result"><div id="no-result"><i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></main><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/utils.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/main.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/header-shrink.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/back2top.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/dark-light-toggle.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/local-search.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/code-block.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/lazyload.js"></script><div class="post-scripts pjax"><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/post-helper.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/libs/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/toc.js"></script></div><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/libs/pjax.min.js"></script><script>window.addEventListener("DOMContentLoaded",()=>{window.pjax=new Pjax({selectors:["head title",".page-container",".pjax"],history:!0,debug:!1,cacheBust:!1,timeout:0,analytics:!1,currentUrlFullReload:!1,scrollRestoration:!1}),document.addEventListener("pjax:send",()=>{KEEP.utils.pjaxProgressBarStart()}),document.addEventListener("pjax:complete",()=>{KEEP.utils.pjaxProgressBarEnd(),window.pjax.executeScripts(document.querySelectorAll("script[data-pjax], .pjax script")),KEEP.refresh()})})</script></body></html>